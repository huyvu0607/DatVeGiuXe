@model ParkingReservationSystem.Models.User
@{
    ViewData["Title"] = "Xóa Người Dùng";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}

<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <!-- Header Section -->
            <div class="d-flex justify-content-between align-items-center mb-4">
                <div>
                    <h2 class="text-danger mb-1">
                        <i class="fas fa-user-times me-2"></i>Xóa Người Dùng
                    </h2>
                    <p class="text-muted mb-0">Xác nhận xóa người dùng khỏi hệ thống</p>
                </div>
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb mb-0">
                        <li class="breadcrumb-item"><a href="#" class="text-decoration-none">Dashboard</a></li>
                        <li class="breadcrumb-item"><a asp-action="Index" class="text-decoration-none">Người Dùng</a></li>
                        <li class="breadcrumb-item active" aria-current="page">Xóa</li>
                    </ol>
                </nav>
            </div>
        </div>
    </div>

    <div class="row justify-content-center">
        <div class="col-lg-8 col-xl-6">
            <!-- Warning Alert -->
            <div class="alert alert-danger border-0 shadow-sm mb-4" role="alert">
                <div class="d-flex align-items-center">
                    <i class="fas fa-exclamation-triangle fa-2x me-3"></i>
                    <div>
                        <h5 class="alert-heading mb-1">Cảnh báo quan trọng!</h5>
                        <p class="mb-0">Bạn đang thực hiện hành động xóa người dùng. Hành động này không thể hoàn tác.</p>
                    </div>
                </div>
            </div>

            <!-- User Info Card -->
            <div class="card shadow-sm border-0">
                <div class="card-header bg-danger text-white">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-user-minus me-2"></i>Thông Tin Người Dùng Sẽ Bị Xóa
                    </h5>
                </div>

                <div class="card-body p-0">
                    <!-- User Preview -->
                    <div class="bg-light p-4 border-bottom">
                        <div class="d-flex align-items-center">
                            <div class="me-3">
                                <div class="bg-danger rounded-circle d-flex align-items-center justify-content-center"
                                     style="width: 60px; height: 60px;">
                                    <i class="fas fa-user fa-2x text-white"></i>
                                </div>
                            </div>
                            <div>
                                <h4 class="mb-1 text-dark">@Html.DisplayFor(model => model.Name)</h4>
                                <p class="mb-1 text-muted">
                                    <i class="fas fa-envelope me-1"></i>@Html.DisplayFor(model => model.Email)
                                </p>
                                <span class="badge @(Model?.Role == "Admin" ? "bg-danger" : "bg-secondary")">
                                    <i class="fas @(Model?.Role == "Admin" ? "fa-crown" : "fa-user") me-1"></i>
                                    @(Model?.Role == "Admin" ? "Quản trị viên" : "Người dùng")
                                </span>
                            </div>
                        </div>
                    </div>

                    <!-- User Details -->
                    <div class="p-4">
                        <h6 class="text-danger mb-3">
                            <i class="fas fa-info-circle me-2"></i>Chi Tiết Sẽ Bị Xóa
                        </h6>

                        <div class="row g-3">
                            <!-- ID -->
                            <div class="col-sm-6">
                                <div class="d-flex align-items-center p-3 border rounded">
                                    <div class="me-3">
                                        <i class="fas fa-hashtag text-muted fa-lg"></i>
                                    </div>
                                    <div>
                                        <small class="text-muted d-block">@Html.DisplayNameFor(model => model.Id)</small>
                                        <strong class="text-dark">@Html.DisplayFor(model => model.Id)</strong>
                                    </div>
                                </div>
                            </div>

                            <!-- Name -->
                            <div class="col-sm-6">
                                <div class="d-flex align-items-center p-3 border rounded">
                                    <div class="me-3">
                                        <i class="fas fa-user text-muted fa-lg"></i>
                                    </div>
                                    <div>
                                        <small class="text-muted d-block">@Html.DisplayNameFor(model => model.Name)</small>
                                        <strong class="text-dark">@Html.DisplayFor(model => model.Name)</strong>
                                    </div>
                                </div>
                            </div>

                            <!-- Email -->
                            <div class="col-sm-6">
                                <div class="d-flex align-items-center p-3 border rounded">
                                    <div class="me-3">
                                        <i class="fas fa-envelope text-muted fa-lg"></i>
                                    </div>
                                    <div>
                                        <small class="text-muted d-block">@Html.DisplayNameFor(model => model.Email)</small>
                                        <strong class="text-dark">@Html.DisplayFor(model => model.Email)</strong>
                                    </div>
                                </div>
                            </div>

                            <!-- Role -->
                            <div class="col-sm-6">
                                <div class="d-flex align-items-center p-3 border rounded">
                                    <div class="me-3">
                                        <i class="fas fa-user-tag text-muted fa-lg"></i>
                                    </div>
                                    <div>
                                        <small class="text-muted d-block">@Html.DisplayNameFor(model => model.Role)</small>
                                        <strong class="text-dark">
                                            @(Model?.Role == "Admin" ? "Quản trị viên" : "Người dùng")
                                        </strong>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Consequences Warning -->
                    <div class="bg-warning bg-opacity-10 p-4 border-top">
                        <h6 class="text-warning mb-3">
                            <i class="fas fa-exclamation-triangle me-2"></i>Hậu Quả Của Việc Xóa
                        </h6>
                        <ul class="list-unstyled mb-0">
                            <li class="mb-2 text-danger">
                                <i class="fas fa-times-circle me-2"></i>
                                Tất cả thông tin cá nhân sẽ bị xóa vĩnh viễn
                            </li>
                            <li class="mb-2 text-danger">
                                <i class="fas fa-times-circle me-2"></i>
                                Lịch sử đặt chỗ của người dùng sẽ bị mất
                            </li>
                            <li class="mb-2 text-danger">
                                <i class="fas fa-times-circle me-2"></i>
                                Không thể khôi phục dữ liệu sau khi xóa
                            </li>
                            <li class="mb-0 text-danger">
                                <i class="fas fa-times-circle me-2"></i>
                                Người dùng sẽ không thể đăng nhập vào hệ thống
                            </li>
                        </ul>
                    </div>

                    <!-- Confirmation Section -->
                    <div class="p-4 border-top">
                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="confirmDelete">
                            <label class="form-check-label fw-semibold text-danger" for="confirmDelete">
                                Tôi hiểu rằng hành động này không thể hoàn tác
                            </label>
                        </div>

                        <form asp-action="Delete" id="deleteForm">
                            <input type="hidden" asp-for="Id" />

                            <div class="d-flex gap-2 justify-content-end">
                                <a asp-action="Index" class="btn btn-outline-secondary">
                                    <i class="fas fa-arrow-left me-2"></i>Hủy và Quay Lại
                                </a>
                                <a asp-action="Details" asp-route-id="@Model?.Id" class="btn btn-outline-info">
                                    <i class="fas fa-eye me-2"></i>Xem Chi Tiết
                                </a>
                                <button type="submit" class="btn btn-danger" id="deleteBtn" disabled>
                                    <i class="fas fa-trash-alt me-2"></i>Xác Nhận Xóa
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Additional Information -->
            <div class="card mt-4 border-0 bg-light">
                <div class="card-body">
                    <h6 class="text-info mb-3">
                        <i class="fas fa-lightbulb me-2"></i>Gợi Ý Thay Thế
                    </h6>
                    <p class="mb-2 small text-muted">
                        <i class="fas fa-info-circle text-info me-2"></i>
                        Thay vì xóa, bạn có thể tạm thời vô hiệu hóa tài khoản người dùng
                    </p>
                    <p class="mb-2 small text-muted">
                        <i class="fas fa-info-circle text-info me-2"></i>
                        Xuất dữ liệu trước khi xóa để lưu trữ nếu cần thiết
                    </p>
                    <p class="mb-0 small text-muted">
                        <i class="fas fa-info-circle text-info me-2"></i>
                        Liên hệ với người dùng trước khi thực hiện xóa tài khoản
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        // Enable/disable delete button based on confirmation checkbox
        document.getElementById('confirmDelete').addEventListener('change', function() {
            const deleteBtn = document.getElementById('deleteBtn');
            deleteBtn.disabled = !this.checked;

            if (this.checked) {
                deleteBtn.classList.remove('btn-secondary');
                deleteBtn.classList.add('btn-danger');
            } else {
                deleteBtn.classList.remove('btn-danger');
                deleteBtn.classList.add('btn-secondary');
            }
        });

        // Form submission with confirmation
        document.getElementById('deleteForm').addEventListener('submit', function(e) {
            const confirmDelete = document.getElementById('confirmDelete').checked;

            if (!confirmDelete) {
                e.preventDefault();
                alert('Vui lòng xác nhận bạn hiểu hậu quả của việc xóa này.');
                return false;
            }

            const finalConfirm = confirm('Đây là lần xác nhận cuối cùng. Bạn có chắc chắn muốn xóa người dùng "' + '@Model?.Name' + '" không?');

            if (!finalConfirm) {
                e.preventDefault();
                return false;
            }

            // Show loading state
            const deleteBtn = document.getElementById('deleteBtn');
            deleteBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Đang xóa...';
            deleteBtn.disabled = true;
        });

        // Auto-focus on checkbox when page loads
        window.addEventListener('load', function() {
            document.getElementById('confirmDelete').focus();
        });
    </script>
}